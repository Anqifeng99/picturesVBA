Sub pictures_lookup()

'The macros lookup a picture by item code from a folder on disk
'To use the macros you should keep pictures with names itemcode.format, like "10001.png" in a single folder
'path to files, excel workbook and pictures, MUST BE ONLY IN ENGLISH LETTERS. There could be an error, _
if the path contains cyrillic, arab, hindi letters, latin letters with diacritic, chinese characters etc.

'choose folder with pictures
Application.FileDialog(msoFileDialogFolderPicker).Show
    pic_folder = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1)

'count number of items

Set art_rng = Application.InputBox("select article cell", "Select article", Type:=8)
Set pic_rng = Application.InputBox("choose cell for pics", "Select pic column", Type:=8)
If art_rng.Cells(1, 1) = "" Then
item_num = Range(art_rng.End(xlDown).Address, Cells(Range(art_rng.End(xlDown).Address).Row + 1, Range(art_rng.End(xlDown).Address).Column).End(xlDown).Address).Rows.Count
    Else: item_num = Range(art_rng.Cells(1, 1), art_rng.End(xlDown).Address).Rows.Count
End If

'prepare cells size to insert pictures

If art_rng.Cells(1, 1) = "" Then
Rows("1:" & item_num + Range(art_rng.End(xlDown).Address).Row).Select
    Else: Rows("1:" & item_num).Row.Select
End If
pic_size = MsgBox("Do you want to get big pictures(144px)?", 4)
If pic_size = 6 Then
Selection.RowHeight = 144
Pic_rng.Columns.Select
    Selection.ColumnWidth = 22
Else: Selection.RowHeight = 72
Pic_rng.Columns.Select
    Selection.ColumnWidth = 15
End If
    
    
For cycle = 2 To items_num

'incert pictures to cells

Worksheets("sheet1").Shapes.AddPicture _
    pic_folder & "\" & Cells(cycle, 1) & ".png", _
    False, _
    True, _
    Cells(cycle, 2).Left, _
    Cells(cycle, 2).Top, _
    -1, -1
    
Next cycle

'fit pictures into cells

Worksheets("sheet1").Shapes.SelectAll
Selection.ShapeRange.Height = 100
Selection.Placement = xlMoveAndSize
    

End Sub
